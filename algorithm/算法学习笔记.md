# ç®—æ³•å­¦ä¹ ç¬”è®°

## ä¸€ã€ç”¨dpæ•°ç»„ä»£æ›¿é€’å½’

```c
#include<iostream>
using namespace std;
int find();
int chess[30][30]={0};
int n,m,x,y;
int output=0;
int nx=0,ny=0;
int main(){
    cin>>n>>m>>x>>y;
    chess[x][y]=-1;
    for(int i=0;i<=n;i++){
        for(int j=0;j<=m;j++){
            if((abs(i-x)+abs(j-y)==3)&&(j!=y)&&(i!=x)) chess[i][j]=-1;
        }
    }
    find();
    cout<<output;
}
int find(){
    if(chess[nx][ny]==-1) return 0;
    if(nx==n&&ny==m){
        output++;
        return 0;
    }
    if(nx<n){
        nx++;
        find();
        nx--;
    }
    if(ny<m){
        ny++;
        find();
        ny--;
    }
    return 0;
}
```

```c
#include<iostream>
using namespace std;

int chess[30][30] = {0};
long long dp[30][30] = {0};
int n, m, x, y;

int main() {
    cin >> n >> m >> x >> y;
    chess[x][y] = -1;

    // æ ‡è®°é©¬çš„æ§åˆ¶èŒƒå›´
    int dx[] = {1, 2, 2, 1, -1, -2, -2, -1};
    int dy[] = {2, 1, -1, -2, -2, -1, 1, 2};
    for (int i = 0; i < 8; i++) {
        int nx = x + dx[i];
        int ny = y + dy[i];
        if (nx >= 0 && nx <= n && ny >= 0 && ny <= m) {
            chess[nx][ny] = -1;
        }
    }

    // åˆå§‹åŒ–dpæ•°ç»„
    dp[0][0] = 1;
    for (int i = 0; i <= n; i++) {
        for (int j = 0; j <= m; j++) {
            if (chess[i][j] == -1) {
                dp[i][j] = 0;
            } else {
                if (i > 0) dp[i][j] += dp[i-1][j];
                if (j > 0) dp[i][j] += dp[i][j-1];
            }
        }
    }

    cout << dp[n][m];
    return 0;
}
```

è‹¥ç›´æ¥ä½¿ç”¨é€’å½’åˆ™å½“æ•°æ®è¾ƒå¤§æ—¶ä¼šå‡ºç°è¶…æ—¶çš„æƒ…å†µï¼Œæ­¤æ—¶éœ€è€ƒè™‘**DPæ•°ç»„** ï¼ˆåŠ¨æ€è§„åˆ’æ•°ç»„ï¼ŒDynamic Programming Arrayï¼‰

### **DPæ•°ç»„çš„ä½œç”¨**

1. **è®°å½•å­é—®é¢˜çš„è§£**
    
    åŠ¨æ€è§„åˆ’å°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªé‡å çš„å­é—®é¢˜ï¼ŒDPæ•°ç»„ç”¨äºå­˜å‚¨è¿™äº›å­é—®é¢˜çš„è§£ï¼Œåç»­ç›´æ¥æŸ¥è¡¨å¤ç”¨ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚
    
2. **çŠ¶æ€è½¬ç§»**
    
    DPæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ é€šå¸¸ä»£è¡¨æŸä¸ªçŠ¶æ€çš„æœ€ä¼˜è§£ï¼ˆå¦‚æœ€å¤§å€¼ã€æœ€å°å€¼æˆ–å¯è¡Œè§£ï¼‰ã€‚é€šè¿‡çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œä»å·²çŸ¥çŠ¶æ€æ¨å¯¼å‡ºæœªçŸ¥çŠ¶æ€çš„å€¼ã€‚
    
3. **ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦**
    
    é€šè¿‡ç©ºé—´æ¢æ—¶é—´ï¼Œå°†æŒ‡æ•°çº§å¤æ‚åº¦çš„æš´åŠ›é€’å½’è½¬åŒ–ä¸ºå¤šé¡¹å¼å¤æ‚åº¦ï¼ˆå¦‚O(n^2)ï¼‰ã€‚
    

### **DPæ•°ç»„çš„å¸¸è§å½¢å¼**

æ ¹æ®é—®é¢˜å¤æ‚åº¦ï¼ŒDPæ•°ç»„å¯ä»¥æ˜¯ä¸€ç»´ã€äºŒç»´ç”šè‡³å¤šç»´ï¼š

- **ä¸€ç»´æ•°ç»„** ï¼šé€‚ç”¨äºå•å˜é‡çŠ¶æ€ï¼ˆå¦‚æ–æ³¢é‚£å¥‘æ•°åˆ—ã€çˆ¬æ¥¼æ¢¯é—®é¢˜ï¼‰ã€‚
    
    ```c
    dp[i] = dp[i-1] + dp[i-2]
    ```
    
- **äºŒç»´æ•°ç»„** ï¼šé€‚ç”¨äºåŒå˜é‡çŠ¶æ€ï¼ˆå¦‚èƒŒåŒ…é—®é¢˜ã€æœ€é•¿å…¬å…±å­åºåˆ—ï¼‰ã€‚
    
    ```c
    dp[i][j] = max(dp[i-1][j], dp[i][j-1]) + 1
    ```
    



### **ç»å…¸ç¤ºä¾‹**

1. **æ–æ³¢é‚£å¥‘æ•°åˆ—**
    
    é€’å½’è§£æ³•é‡å¤è®¡ç®—ä¸¥é‡ï¼Œè€ŒDPæ•°ç»„åªéœ€çº¿æ€§æ—¶é—´ï¼š
    
    ```python
    dp = [0] * (n+1)
    dp[0] = 0
    dp[1] = 1
    for i in range(2, n+1):
        dp[i] = dp[i-1] + dp[i-2]
    ```
    
2. èµ°è¿·å®«è·¯å¾„æ€»æ•°é—®é¢˜
    
    ```python
    dp[i][j] = dp[i-1][j] + dp[i][j-1]
    ```
    



### **å…³é”®ç‚¹**

- **åˆå§‹åŒ–** ï¼šæ ¹æ®é—®é¢˜å®šä¹‰åˆå§‹æ¡ä»¶ï¼ˆå¦‚**`dp[0]`**æˆ–**`dp[0][0]`**ï¼‰ã€‚
- **éå†é¡ºåº** ï¼šç¡®ä¿çŠ¶æ€è½¬ç§»æ—¶å­é—®é¢˜çš„è§£å·²è®¡ç®—ã€‚
- **ç©ºé—´ä¼˜åŒ–** ï¼šéƒ¨åˆ†é—®é¢˜å¯å‹ç¼©DPæ•°ç»„ç»´åº¦ï¼ˆå¦‚ç”¨æ»šåŠ¨æ•°ç»„å°†äºŒç»´è½¬ä¸€ç»´ï¼‰ã€‚

DPæ•°ç»„æ˜¯è§£å†³æœ€ä¼˜åŒ–ã€è®¡æ•°ç±»é—®é¢˜ï¼ˆå¦‚æœ€é•¿é€’å¢å­åºåˆ—ã€ç¼–è¾‘è·ç¦»ï¼‰çš„é‡è¦å·¥å…·ï¼ŒæŒæ¡å…¶è®¾è®¡ä¸çŠ¶æ€è½¬ç§»æ–¹ç¨‹æ˜¯åŠ¨æ€è§„åˆ’çš„å…³é”®ã€‚

## äºŒã€ç”¨æ•°ç»„ä»£æ›¿æ•´æ•°è¿›è¡Œé«˜ç²¾åº¦è®¡ç®—

åœ¨C++ä¸­å¤„ç†è¶…å¤§æ•´æ•°çš„é«˜ç²¾åº¦è®¡ç®—é€šå¸¸ä½¿ç”¨æ•°ç»„æ¥æ¨¡æ‹Ÿæ¯ä¸€ä½æ•°å­—ï¼Œå¹¶æ‰‹åŠ¨å®ç°ç®—æœ¯è¿ç®—ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„å®ç°æ–¹æ³•ï¼š

### **1. å­˜å‚¨æ–¹å¼**

ä½¿ç”¨`vector<int>`å­˜å‚¨æ•°å­—ï¼Œâ€‹**ä½ä½åœ¨å‰**ä»¥ä¾¿äºå¤„ç†è¿›ä½å’Œå€Ÿä½ã€‚ä¾‹å¦‚ï¼Œæ•°å€¼`1234`å­˜å‚¨ä¸º`[4,3,2,1]`ã€‚

### **2. è¾“å…¥è¾“å‡ºè½¬æ¢**

å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°ç»„ï¼Œå¹¶å¤„ç†å‰å¯¼é›¶ï¼š

```c
vector<int> stringToVector(const string& s) {
    vector<int> res;
    for (int i = s.size() - 1; i >= 0; --i) {
        res.push_back(s[i] - '0');
    }
// å»é™¤è¾“å…¥çš„å‰å¯¼é›¶ï¼Œä¾‹å¦‚ "00123" -> "123"
    while (res.size() > 1 && res.back() == 0) {
        res.pop_back();
    }
    return res;
}

string vectorToString(const vector<int>& v) {
    if (v.empty()) return "0";
    string s;
    for (int i = v.size() - 1; i >= 0; --i) {
        s += (v[i] + '0');
    }
    return s;
}
```

### **3. åŠ æ³•**

é€ä½ç›¸åŠ å¹¶å¤„ç†è¿›ä½ï¼š

```c
vector<int> add(const vector<int>& a, const vector<int>& b) {
    vector<int> res;
    int carry = 0;
    for (int i = 0; i < max(a.size(), b.size()) || carry; ++i) {
        int digitA = (i < a.size()) ? a[i] : 0;
        int digitB = (i < b.size()) ? b[i] : 0;
        int sum = digitA + digitB + carry;
        res.push_back(sum % 10);
        carry = sum / 10;
    }
    return res;
}
```

### **4. å‡æ³•ï¼ˆå‡è®¾a â‰¥ bï¼‰**

é€ä½ç›¸å‡å¹¶å¤„ç†å€Ÿä½ï¼Œæœ€åå»é™¤å‰å¯¼é›¶ï¼š

```c
vector<int> subtract(const vector<int>& a, const vector<int>& b) {
    vector<int> res;
    int borrow = 0;
    for (int i = 0; i < a.size(); ++i) {
        int digitA = a[i] - borrow;
        int digitB = (i < b.size()) ? b[i] : 0;
        borrow = (digitA < digitB) ? 1 : 0;
        if (borrow) digitA += 10;
        res.push_back(digitA - digitB);
    }
// å»é™¤é«˜ä½é›¶
    while (res.size() > 1 && res.back() == 0) {
        res.pop_back();
    }
    return res;
}
```

### **5. ä¹˜æ³•**

æŒ‰ä½ç›¸ä¹˜å¹¶ç´¯åŠ ï¼Œæœ€åå¤„ç†è¿›ä½ï¼š

```c
vector<int> multiply(const vector<int>& a, const vector<int>& b) {
    vector<int> res(a.size() + b.size(), 0);
    for (int i = 0; i < a.size(); ++i) {
        for (int j = 0; j < b.size(); ++j) {
            res[i + j] += a[i] * b[j];
        }
    }
// ç»Ÿä¸€å¤„ç†è¿›ä½
    int carry = 0;
    for (int k = 0; k < res.size(); ++k) {
        int value = res[k] + carry;
        res[k] = value % 10;
        carry = value / 10;
    }
// å»é™¤é«˜ä½é›¶
    while (res.size() > 1 && res.back() == 0) {
        res.pop_back();
    }
    return res;
}
```

### **6. é™¤æ³•ï¼ˆé«˜ç²¾åº¦é™¤ä»¥ä½ç²¾åº¦ï¼‰**

æ­¤å¤„ä»¥é«˜ç²¾åº¦æ•°é™¤ä»¥æ™®é€šæ•´æ•°ä¸ºä¾‹ï¼š

```c
vector<int> divide(const vector<int>& a, int b, int& remainder) {
    vector<int> res;
    remainder = 0;
    for (int i = a.size() - 1; i >= 0; --i) {// ä»é«˜ä½å¼€å§‹å¤„ç†
        remainder = remainder * 10 + a[i];
        res.push_back(remainder / b);
        remainder %= b;
    }
    reverse(res.begin(), res.end());
// å»é™¤é«˜ä½é›¶
    while (res.size() > 1 && res.back() == 0) {
        res.pop_back();
    }
    return res;
}
```

### **7. é«˜ç²¾åº¦æ¯”è¾ƒ**

æ¯”è¾ƒä¸¤ä¸ªé«˜ç²¾åº¦æ•°çš„å¤§å°ï¼š

```c
int compare(const vector<int>& a, const vector<int>& b) {
    if (a.size() != b.size()) {
        return a.size() > b.size() ? 1 : -1;
    }
    for (int i = a.size() - 1; i >= 0; --i) {// é«˜ä½åœ¨æ•°ç»„æœ«å°¾
        if (a[i] != b[i]) return a[i] > b[i] ? 1 : -1;
    }
    return 0;
}
```

### **8. ç¤ºä¾‹ç”¨æ³•**

```c
int main() {
    string s1 = "123456789";
    string s2 = "987654321";

    vector<int> num1 = stringToVector(s1);
    vector<int> num2 = stringToVector(s2);

    vector<int> sum = add(num1, num2);
    cout << "Sum: " << vectorToString(sum) << endl;

    if (compare(num1, num2) >= 0) {
        vector<int> diff = subtract(num1, num2);
        cout << "Difference: " << vectorToString(diff) << endl;
    } else {
        cout << "num1 is smaller than num2" << endl;
    }

    vector<int> product = multiply(num1, num2);
    cout << "Product: " << vectorToString(product) << endl;

    int divisor = 123;
    int remainder;
    vector<int> quotient = divide(num1, divisor, remainder);
    cout << "Quotient: " << vectorToString(quotient)
         << ", Remainder: " << remainder << endl;

    return 0;
}
```

### **è¯´æ˜**

- â€‹**é«˜ç²¾åº¦é™¤ä»¥é«˜ç²¾åº¦**çš„å®ç°è¾ƒä¸ºå¤æ‚ï¼Œé€šå¸¸æ¶‰åŠè¯•å•†æ³•æˆ–äºŒåˆ†æŸ¥æ‰¾ï¼Œéœ€è¦ç»“åˆå‡æ³•ã€ä¹˜æ³•å’Œæ¯”è¾ƒæ“ä½œã€‚
- ä¸Šè¿°ä»£ç æœªå¤„ç†è´Ÿæ•°ï¼Œå®é™…åº”ç”¨ä¸­å¯æ·»åŠ ç¬¦å·ä½å¹¶åœ¨è¿ç®—æ—¶å¤„ç†ç¬¦å·é€»è¾‘ã€‚
- é™¤æ³•ç¤ºä¾‹å±•ç¤ºäº†é™¤ä»¥æ™®é€šæ•´æ•°çš„æ–¹æ³•ï¼Œé«˜ç²¾åº¦ä¹‹é—´çš„é™¤æ³•éœ€è¦æ›´å¤æ‚çš„é€»è¾‘ï¼Œå»ºè®®å‚è€ƒä¸“é—¨çš„é«˜ç²¾åº¦ç®—æ³•åº“æˆ–è¿›ä¸€æ­¥å­¦ä¹ è¯•å•†æ³•ã€‚

## ä¸‰ã€BFSä¸å¹¶æŸ¥é›†è·¯å¾„å‹ç¼©

### é¢˜ç›®æè¿°

è·³æˆ¿å­æ¸¸æˆæ˜¯è¥¿è¥¿è‰¾å¼—å²›ä¸Šå­©å­ä»¬çš„ä¼ ç»Ÿå¨±ä¹æ–¹å¼ã€‚ä»Šå¤©å° P é€ è®¿äº†è¥¿è¥¿è‰¾å¼—å²›ï¼Œå° C å‘ä»–ç¤ºèŒƒäº†è·³æˆ¿å­æ¸¸æˆè¯¥æ€ä¹ˆç©ã€‚

åœ¨åœ°é¢ä¸Šæœ‰ä¸€å­—æ’å¼€çš„$n$ä¸ªæ ¼å­ï¼Œæ¯ä¸ªæ ¼å­ä¸Šéƒ½å†™ç€ä¸€ä¸ªæ•°å­—ï¼Œç¬¬$i$ä¸ªæ ¼å­ä¸Šå†™ç€çš„æ•°å­—æ˜¯$a_i$ã€‚è¿™äº›æ•°å­—æ»¡è¶³$a_i < i$ä¸”$a_n = 0$ã€‚

ä¸€å¼€å§‹ï¼Œå° C ç«™åœ¨ç¬¬ä¸€ä¸ªæ ¼å­ä¸Šã€‚å° C æ˜¯ä¸€ä¸ªæ“…é•¿è·³è·ƒçš„äººï¼Œä»–å¯ä»¥å¾€å‰è·³å¾ˆè¿œï¼Œä½†ä¸ºäº†æ¸¸æˆçš„è¶£å‘³æ€§ï¼Œå° C è§„å®šåœ¨ç¬¬$i$ä¸ªæ ¼å­ä¸Šæœ€å¤šèƒ½å¾€å‰è·³$k_i$æ ¼ï¼Œè€Œä¸”ä¸èƒ½è·³åˆ°ç¬¬$n$ä¸ªæ ¼å­åé¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå° C ç°åœ¨ç«™åœ¨ç¬¬$i$ä¸ªæ ¼å­ä¸Šï¼Œé‚£ä¹ˆä»–å¯ä»¥è·³åˆ°ç¬¬$i+1$ä¸ªæ ¼å­å’Œç¬¬$\min(n, i + k_i)$ä¸ªæ ¼å­ä¹‹é—´çš„ä»»æ„æ ¼å­ä¸Šã€‚

æ ¹æ®è·³æˆ¿å­æ¸¸æˆçš„è§„åˆ™ï¼Œå¦‚æœå° C åœ¨ä¸€æ¬¡è·³è·ƒä¹‹åè½åˆ°äº†ç¬¬$i$ä¸ªæ ¼å­ä¸Šï¼Œé‚£ä¹ˆä»–éœ€è¦åé€€$a_i$æ ¼ï¼Œä¹Ÿå°±æ˜¯è¯´å° C åœ¨è·³è·ƒåä¼šç«™åœ¨ç¬¬$i - a_i$ä¸ªæ ¼å­ä¸Šã€‚

ç©äº†ä¸€ä¼šä¹‹åï¼Œå° P çªç„¶å¥½å¥‡ï¼Œå° C æœ€å°‘éœ€è¦è·³å¤šå°‘æ¬¡æ‰èƒ½åˆ°è¾¾ç¬¬$n$ä¸ªæ ¼å­å‘¢ï¼Ÿå° C ä¹Ÿä¸çŸ¥é“è¿™ä¸ªç­”æ¡ˆï¼Œäºæ˜¯ä»–åªèƒ½æ¥è¯·æ•™ä½ ã€‚

#### è¾“å…¥æ ¼å¼

ç¬¬ä¸€è¡Œä¸€ä¸ªæ­£æ•´æ•°$n$ï¼Œä»£è¡¨æ ¼å­çš„æ•°é‡ã€‚

ç¬¬äºŒè¡Œ$n$ä¸ªéè´Ÿæ•´æ•°$a_1, a_2, \ldots, a_n$ï¼Œå…¶ä¸­$a_i$è¡¨ç¤ºç¬¬$i$ä¸ªæ ¼å­ä¸Šçš„æ•°å­—ã€‚

ç¬¬ä¸‰è¡Œ$n$ä¸ªéè´Ÿæ•´æ•°$k_1, k_2, \ldots, k_n$ï¼Œå…¶ä¸­$k_i$è¡¨ç¤ºå° C åœ¨ç¬¬$i$ä¸ªæ ¼å­æ—¶èƒ½å¾€å‰è·³çš„æœ€å¤§æ ¼æ•°ã€‚

#### è¾“å‡ºæ ¼å¼

è¾“å‡ºä¸€è¡Œä¸€ä¸ªæ•´æ•°è¡¨ç¤ºå° C åˆ°è¾¾ç¬¬$n$ä¸ªæ ¼å­éœ€è¦çš„æœ€å°‘è·³è·ƒæ¬¡æ•°ï¼Œå¦‚æœå° C ä¸èƒ½åˆ°è¾¾ç¬¬$n$ä¸ªæ ¼å­è¾“å‡º$-1$ã€‚

```c
#include <bits/stdc++.h>
using namespace std;

const int MAXN = 1e5 + 5;

// å¹¶æŸ¥é›†ç›¸å…³
int fa[MAXN]; // å¹¶æŸ¥é›†æ•°ç»„ï¼Œç”¨äºå¿«é€Ÿæ‰¾åˆ°æœªå¤„ç†çš„èŠ‚ç‚¹

// è·¯å¾„å‹ç¼©çš„æŸ¥æ‰¾å‡½æ•°
int find(int x) {
    if (fa[x] != x) fa[x] = find(fa[x]); // è·¯å¾„å‹ç¼©ä¼˜åŒ–
    return fa[x];
}

int main() {
    int n;
    cin >> n;
    int a[n+1], k[n+1], dp[n+1]; // è¾“å…¥æ•°æ®æ•°ç»„å’ŒDPæ•°ç»„

    // è¯»å–è¾“å…¥æ•°æ®
    for (int i = 1; i <= n; i++) {
        cin >> a[i];
        dp[i] = -1; // åˆå§‹åŒ–DPä¸º-1ï¼ˆè¡¨ç¤ºæœªåˆ°è¾¾ï¼‰
    }
    for (int i = 1; i <= n; i++) {
        cin >> k[i];
    }

    // é¢„å¤„ç†ï¼šè®¡ç®—æ¯ä¸ªä½ç½®jè·³è·ƒåçš„å®é™…ç›®æ ‡ä½ç½®
    int pos[n+1]; // pos[j] = j - a[j]
    for (int j = 1; j <= n; j++) {
        pos[j] = j - a[j];
    }

    // åˆå§‹åŒ–å¹¶æŸ¥é›†ï¼ˆæ¯ä¸ªä½ç½®æŒ‡å‘è‡ªå·±ï¼‰
    for (int j = 1; j <= n+1; j++) {
        fa[j] = j;
    }

    // BFSåˆå§‹åŒ–
    queue<int> q;
    dp[1] = 0;    // èµ·ç‚¹æ­¥æ•°ä¸º0
    q.push(1);    // ä»èµ·ç‚¹å¼€å§‹æœç´¢

    while (!q.empty()) {
        int i = q.front(); // å½“å‰å¤„ç†çš„ä½ç½®
        q.pop();

        // ç¡®å®šè·³è·ƒèŒƒå›´[i+1, i+k[i]]
        int start = i + 1;
        int end = i + k[i];
        if (end > n) end = n; // é˜²æ­¢è¶Šç•Œ

        if (start > end) continue; // æ— æ•ˆèŒƒå›´ç›´æ¥è·³è¿‡

        // ä½¿ç”¨å¹¶æŸ¥é›†å¿«é€Ÿéå†å¯åˆ°è¾¾çš„èŠ‚ç‚¹
        int j = find(start); // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœªå¤„ç†çš„èŠ‚ç‚¹
        while (j <= end) {
            int p = pos[j]; // è®¡ç®—å®é™…ç›®æ ‡ä½ç½®

            // å¦‚æœç›®æ ‡ä½ç½®æœªåˆ°è¾¾è¿‡
            if (dp[p] == -1) {
                dp[p] = dp[i] + 1; // æ›´æ–°æ­¥æ•°
                q.push(p);         // åŠ å…¥é˜Ÿåˆ—ç»§ç»­æœç´¢
            }

            // å°†å½“å‰èŠ‚ç‚¹æ ‡è®°ä¸ºå·²å¤„ç†ï¼ˆæŒ‡å‘ä¸‹ä¸€ä¸ªä½ç½®ï¼‰
            fa[j] = find(j + 1);
            // ç»§ç»­æŸ¥æ‰¾ä¸‹ä¸€ä¸ªæœªå¤„ç†çš„èŠ‚ç‚¹
            j = find(j);
        }
    }

    cout << dp[n]; // è¾“å‡ºåˆ°è¾¾ç»ˆç‚¹çš„æœ€å°æ­¥æ•°
    return 0;
}
```

### é‡ç‚¹ï¼šfa[i]æ•°ç»„ä¸findå‡½æ•°æ¥é¿å…é‡å¤å¤„ç†

è€ƒè™‘ä½¿ç”¨BFSï¼ˆå¹¿åº¦ä¼˜å…ˆå¤„ç†ï¼‰ï¼Œåˆ™æ¯ä¸ªèŠ‚ç‚¹åªéœ€è¢«å¤„ç†ä¸€æ¬¡ï¼ˆç›¸åŒèŠ‚ç‚¹çš„åç»­å¤„ç†æ‰€ç”¨æ­¥æ•°ä¸€å®šå¤§äºç¬¬ä¸€æ¬¡å¤„ç†ï¼‰ã€‚åˆ©ç”¨faæ•°ç»„åˆ™å¯ä»¥ç´¢å¼•åˆ°ä¸‹ä¸€ä¸ªæœªè¢«å¤„ç†è¿‡çš„èŠ‚ç‚¹ã€‚

åœ¨ä»£ç ä¸­ï¼Œ`fa[i]`Â æ˜¯**å¹¶æŸ¥é›†ï¼ˆUnion-Findï¼‰çš„æ•°æ®ç»“æ„**ï¼Œå…¶æ ¸å¿ƒæ„ä¹‰æ˜¯**åŠ¨æ€ç»´æŠ¤æœªå¤„ç†çš„èŠ‚ç‚¹ï¼Œå®ç°è·³è·ƒå¼éå†çš„é«˜æ•ˆæ€§**ã€‚ä»¥ä¸‹æ˜¯å…·ä½“è§£æï¼š



### **`fa[i]`Â çš„æ ¸å¿ƒæ„ä¹‰**

1. **åˆå§‹çŠ¶æ€**ï¼š
    - æ¯ä¸ªä½ç½®Â `i`Â çš„Â `fa[i]`Â åˆå§‹åŒ–ä¸ºÂ `i`ï¼ˆå³æŒ‡å‘è‡ªå·±ï¼‰ã€‚
    - **å«ä¹‰**ï¼šæ‰€æœ‰ä½ç½®å‡æœªè¢«å¤„ç†ï¼Œå±äºç‹¬ç«‹çš„é›†åˆã€‚
2. **å¤„ç†è¿‡ç¨‹ä¸­çš„åŠ¨æ€æ›´æ–°**ï¼š
    - å½“å¤„ç†ä½ç½®Â `i`Â çš„è·³è·ƒèŒƒå›´Â `[i+1, i+k[i]]`Â æ—¶ï¼Œé€šè¿‡Â `find`Â å‡½æ•°å¿«é€Ÿæ‰¾åˆ°è¯¥èŒƒå›´å†…ç¬¬ä¸€ä¸ªæœªå¤„ç†çš„èŠ‚ç‚¹Â `j`ã€‚
    - **å¤„ç†å®ŒÂ `j`Â å**ï¼šå°†Â `fa[j]`Â æŒ‡å‘Â `j+1`ï¼Œå³Â `fa[j] = find(j+1)`ã€‚
    - **æ•ˆæœ**ï¼šåç»­å†æ¬¡è®¿é—®åˆ°Â `j`Â æ—¶ï¼Œ`find(j)`Â ä¼šç›´æ¥è·³è¿‡Â `j`ï¼Œè¿”å›Â `j+1`Â çš„æ ¹èŠ‚ç‚¹ã€‚
3. **è·¯å¾„å‹ç¼©ä¼˜åŒ–**ï¼š
    - `find`Â å‡½æ•°é€šè¿‡é€’å½’è·¯å¾„å‹ç¼©ï¼Œä½¿å¾—æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ç›´æ¥æŒ‡å‘æ ¹èŠ‚ç‚¹ã€‚
    - **ç»“æœ**ï¼š`fa[i]`Â æœ€ç»ˆå½¢æˆä¸€ä¸ªâ€œæŒ‡é’ˆé“¾â€ï¼Œå°†æ‰€æœ‰å·²å¤„ç†çš„èŠ‚ç‚¹é“¾æ¥åˆ°æœªå¤„ç†èŠ‚ç‚¹çš„èµ·å§‹ä½ç½®ã€‚



### **`fa[i]`Â çš„å…·ä½“ä½œç”¨**

**1. å¿«é€Ÿå®šä½æœªå¤„ç†çš„èŠ‚ç‚¹**

- **é—®é¢˜**ï¼šåœ¨ BFS éå†ä¸­ï¼Œæ¯æ¬¡éœ€è¦å¤„ç†Â `[i+1, i+k[i]]`Â èŒƒå›´å†…çš„èŠ‚ç‚¹ã€‚è‹¥é€ä¸ªæ£€æŸ¥æ˜¯å¦å·²å¤„ç†ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(nÂ²)ã€‚
- **è§£å†³æ–¹æ¡ˆ**ï¼š
    - ä½¿ç”¨Â `find(j)`Â æ‰¾åˆ°èŒƒå›´å†…ç¬¬ä¸€ä¸ªæœªè¢«å¤„ç†çš„èŠ‚ç‚¹ã€‚
    - ä¾‹å¦‚ï¼Œè‹¥Â `j=2`Â å·²å¤„ç†ï¼Œåˆ™Â `find(2)`Â è¿”å›Â `3`ï¼Œç›´æ¥è·³è¿‡å·²å¤„ç†çš„Â `2`ã€‚

**2. æ ‡è®°å·²å¤„ç†çš„èŠ‚ç‚¹**

- **æ“ä½œ**ï¼šå¤„ç†å®ŒèŠ‚ç‚¹Â `j`Â åï¼Œæ‰§è¡ŒÂ `fa[j] = find(j+1)`ã€‚
- **æ•ˆæœ**ï¼š
    - å°†Â `j`Â çš„çˆ¶èŠ‚ç‚¹æŒ‡å‘Â `j+1`Â çš„æ ¹èŠ‚ç‚¹ã€‚
    - åç»­è°ƒç”¨Â `find(j)`Â æ—¶ï¼Œç›´æ¥è¿”å›Â `j+1`Â çš„æ ¹èŠ‚ç‚¹ï¼Œä»è€Œè·³è¿‡Â `j`ã€‚

**3. ç»´æŠ¤è·³è·ƒå¼éå†**

- **å…³é”®é€»è¾‘**ï¼š
    
    ```c
    int j = find(start);// æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœªå¤„ç†çš„èŠ‚ç‚¹
    while (j <= end) {
        process(j);// å¤„ç†èŠ‚ç‚¹ j
        fa[j] = find(j+1);// æ ‡è®° j ä¸ºå·²å¤„ç†
        j = find(j);// è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæœªå¤„ç†çš„èŠ‚ç‚¹
    }
    ```
    
- **è¿‡ç¨‹ç¤ºæ„å›¾**ï¼š
    
    ```
    åˆå§‹çŠ¶æ€: [1]->1, [2]->2, [3]->3, [4]->4, [5]->5
    å¤„ç† j=2 å: [2]->3, [3]->3 â†’ find(2) è¿”å› 3
    å¤„ç† j=3 å: [3]->4, [4]->4 â†’ find(3) è¿”å› 4
    ```
    



### **ç¤ºä¾‹æ¼”ç®—**

å‡è®¾Â `n=5`ï¼Œåˆå§‹Â `fa[] = [1,2,3,4,5]`ï¼š

| **æ­¥éª¤** | **æ“ä½œ** | **`fa[]`Â å˜åŒ–** | **è¯´æ˜** |
|  |  |  |  |
| 1 | å¤„ç†Â `i=1`ï¼ŒèŒƒå›´Â `[2,3]` | `fa[2]=3`,Â `fa[3]=4` | `find(2)`Â ç›´æ¥è¿”å› 3 â†’ è·³è¿‡ 2 |
| 2 | å¤„ç†Â `i=3`ï¼ŒèŒƒå›´Â `[4,6]` | `fa[4]=5`,Â `fa[5]=6` | `find(4)`Â è¿”å› 5 â†’ å¤„ç† 4 |

æœ€ç»ˆï¼Œæ‰€æœ‰èŠ‚ç‚¹è¢«é«˜æ•ˆå¤„ç†ï¼Œæ— éœ€é‡å¤æ£€æŸ¥ã€‚



### **ä¸ºä»€ä¹ˆéœ€è¦Â `fa[i]`ï¼Ÿ**

1. **é¿å…é‡å¤å¤„ç†**ï¼š
    - é€šè¿‡Â `fa[i]`Â çš„æŒ‡é’ˆé“¾ï¼Œç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä»…è¢«å¤„ç†ä¸€æ¬¡ã€‚
2. **æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–**ï¼š
    - ä¼ ç»Ÿ BFS éå†éœ€è¦ O(nÂ²) æ—¶é—´ï¼ˆæ¯æ¬¡æ£€æŸ¥æ‰€æœ‰è·³è·ƒä½ç½®ï¼‰ã€‚
    - ä½¿ç”¨å¹¶æŸ¥é›†åï¼Œæ—¶é—´å¤æ‚åº¦é™è‡³ **O(n Î±(n))**ï¼ˆæ¥è¿‘çº¿æ€§ï¼‰ã€‚



### **è·¯å¾„å‹ç¼©çš„ç›®æ ‡**

- **æ ¸å¿ƒé—®é¢˜**ï¼šä¼ ç»Ÿçš„å¹¶æŸ¥é›†åœ¨å¤šæ¬¡åˆå¹¶åï¼Œæ ‘å¯èƒ½é€€åŒ–æˆé“¾çŠ¶ç»“æ„ï¼ˆå¦‚Â `1 â†’ 2 â†’ 3 â†’ 4`ï¼‰ï¼Œå¯¼è‡´æŸ¥æ‰¾æ ¹èŠ‚ç‚¹çš„å¤æ‚åº¦ä¸º **O(n)**ã€‚
- **ä¼˜åŒ–ç›®æ ‡**ï¼šé€šè¿‡å‹ç¼©æŸ¥æ‰¾è·¯å¾„ï¼Œä½¿å¾—æ¯ä¸ªèŠ‚ç‚¹ç›´æ¥æŒ‡å‘æ ¹èŠ‚ç‚¹ï¼Œé™ä½åç»­æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦è‡³ **æ¥è¿‘ O(1)**ã€‚



### **è·¯å¾„å‹ç¼©çš„å®ç°**

åœ¨ä»£ç ä¸­ï¼Œè·¯å¾„å‹ç¼©é€šè¿‡é€’å½’æˆ–è¿­ä»£çš„æŸ¥æ‰¾å‡½æ•°å®ç°ã€‚ä»¥ä¸‹æ˜¯ä»£ç ä¸­çš„å…³é”®å‡½æ•°ï¼š

```c
int find(int x) {
    if (fa[x] != x)
        fa[x] = find(fa[x]);// é€’å½’è·¯å¾„å‹ç¼©
    return fa[x];
}
```

### **é€’å½’å‹ç¼©è¿‡ç¨‹**

1. **æŸ¥æ‰¾æ ¹èŠ‚ç‚¹**ï¼šé€’å½’æŸ¥æ‰¾Â `x`Â çš„çˆ¶èŠ‚ç‚¹ï¼Œç›´åˆ°æ‰¾åˆ°æ ¹èŠ‚ç‚¹ï¼ˆ`fa[root] = root`ï¼‰ã€‚
2. **å‹ç¼©è·¯å¾„**ï¼šåœ¨é€’å½’è¿”å›æ—¶ï¼Œå°†è·¯å¾„ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹ç›´æ¥æŒ‡å‘æ ¹èŠ‚ç‚¹ã€‚

### **ç¤ºä¾‹æ¼”ç®—**

å‡è®¾åˆå§‹æ ‘ç»“æ„ä¸ºÂ `1 â†’ 2 â†’ 3 â†’ 4`ï¼ˆæ ¹èŠ‚ç‚¹æ˜¯1ï¼‰ï¼š

- **è°ƒç”¨Â `find(4)`**ï¼š
    - `fa[4] = 3`Â â†’ é€’å½’è°ƒç”¨Â `find(3)`ã€‚
    - `fa[3] = 2`Â â†’ é€’å½’è°ƒç”¨Â `find(2)`ã€‚
    - `fa[2] = 1`Â â†’ é€’å½’è°ƒç”¨Â `find(1)`ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰ã€‚
    - **å›æº¯æ—¶æ›´æ–°è·¯å¾„**ï¼š
        - `fa[3] = 1`ï¼ˆåŸæŒ‡å‘2ï¼Œç°åœ¨ç›´æ¥æŒ‡å‘æ ¹1ï¼‰ã€‚
        - `fa[4] = 1`ï¼ˆåŸæŒ‡å‘3ï¼Œç°åœ¨ç›´æ¥æŒ‡å‘æ ¹1ï¼‰ã€‚
- **æœ€ç»ˆæ ‘ç»“æ„**ï¼šæ‰€æœ‰èŠ‚ç‚¹ç›´æ¥æŒ‡å‘æ ¹èŠ‚ç‚¹Â `1`ã€‚



### **è·¯å¾„å‹ç¼©çš„å¤æ‚åº¦åˆ†æ**

- **å•æ¬¡æŸ¥æ‰¾**ï¼šæ¥è¿‘ **O(1)**ï¼ˆä¸¥æ ¼æ¥è¯´æ˜¯ O(Î±(n))ï¼Œå…¶ä¸­ Î± æ˜¯é˜¿å…‹æ›¼å‡½æ•°çš„åå‡½æ•°ï¼Œå¢é•¿ææ…¢ï¼‰ã€‚
- **å¤šæ¬¡æ“ä½œ**ï¼šç»è¿‡è·¯å¾„å‹ç¼©åï¼ŒN æ¬¡æ“ä½œçš„å‡æ‘Šæ—¶é—´å¤æ‚åº¦æ¥è¿‘ **O(N)**ã€‚



### **è·¯å¾„å‹ç¼©çš„é€‚ç”¨åœºæ™¯**

1. **é¢‘ç¹æŸ¥æ‰¾æ“ä½œ**ï¼šéœ€è¦å¤šæ¬¡æŸ¥è¯¢æ ¹èŠ‚ç‚¹çš„åœºæ™¯ï¼ˆå¦‚åŠ¨æ€è¿é€šæ€§é—®é¢˜ï¼‰ã€‚
2. **å¤§è§„æ¨¡æ•°æ®**ï¼šå½“æ•°æ®é‡æå¤§æ—¶ï¼Œè·¯å¾„å‹ç¼©çš„ä¼˜åŒ–æ•ˆæœæ˜¾è‘—ã€‚
3. **ä¸ BFS/DFS ç»“åˆ**ï¼šåœ¨éœ€è¦é«˜æ•ˆè·³è¿‡å·²å¤„ç†èŠ‚ç‚¹çš„ç®—æ³•ä¸­ï¼ˆå¦‚æœ¬é¢˜çš„è·³è·ƒé—®é¢˜ï¼‰ã€‚

## å››ã€çº¿æ®µæ ‘

å·²çŸ¥ä¸€ä¸ªæ•°åˆ—ï¼Œä½ éœ€è¦è¿›è¡Œä¸‹é¢ä¸¤ç§æ“ä½œï¼š

1. å°†æŸåŒºé—´å†…çš„æ¯ä¸€ä¸ªæ•°åŠ ä¸Šk
2. æ±‚å‡ºæŸç©ºé—´å†…çš„æ‰€æœ‰æ•°çš„å’Œ

ä½¿ç”¨å¸¸è§„æ–¹æ³•åˆ™æ¯æ¬¡æ“ä½œçš„æ—¶é—´å¤æ‚åº¦å‡ä¸ºO(n)ï¼Œè€ƒè™‘ä½¿ç”¨çº¿æ®µæ ‘å°†æ—¶é—´å¤æ‚åº¦ç¼©çŸ­åˆ°O(log n) 

![image.png](image%201.png)

çº¿æ®µæ ‘æ¨¡æ¿ï¼š

```c
#include <bits/stdc++.h>
using namespace std;
using ll=long long;
ll n, a[100005], d[270000], b[270000]; 
// n:æ•°ç»„é•¿åº¦ a:åŸæ•°ç»„ d:çº¿æ®µæ ‘æ•°ç»„ b:æ‡’æ ‡è®°æ•°ç»„
//build:å»ºæ ‘ update:æ›´æ–° getsum:æŸ¥è¯¢
void build(ll l,ll r,ll p){  // l:åŒºé—´å·¦ç«¯ç‚¹ r:åŒºé—´å³ç«¯ç‚¹ p:èŠ‚ç‚¹æ ‡å·
    if(l==r){
        d[p]=a[l];
        return;
    }
    ll m = l + (r-l)/2;
    build(l,m,p*2);
    build(m+1,r,p*2+1);
    d[p]=d[p*2]+d[p*2+1];
}

void update(ll l,ll r,ll c,ll s,ll t,ll p){  // l:åŒºé—´å·¦ç«¯ç‚¹ r:åŒºé—´å³ç«¯ç‚¹ c:å¢åŠ çš„å€¼ s:ä¿®æ”¹çš„åŒºé—´å·¦ç«¯ç‚¹ t:ä¿®æ”¹çš„åŒºé—´å³ç«¯ç‚¹ p:èŠ‚ç‚¹æ ‡å·
    if(l<=s && t<=r){
        d[p]+=(t-s+1)*c;
        b[p]+=c;
        return;
    }
    ll m = s + (t-s)/2;
    if(b[p]){
        d[p*2]+=(m-s+1)*b[p];
        d[p*2+1]+=(t-m)*b[p];
        b[p*2]+=b[p];
        b[p*2+1]+=b[p];
        b[p]=0;
    }
    if(l<=m) update(l,r,c,s,m,p*2);
    if(r>m) update(l,r,c,m+1,t,p*2+1);
    d[p]=d[p*2]+d[p*2+1];
}

ll getsum(ll l,ll r,ll s,ll t,ll p){ // l:åŒºé—´å·¦ç«¯ç‚¹ r:åŒºé—´å³ç«¯ç‚¹ s:æŸ¥è¯¢çš„åŒºé—´å·¦ç«¯ç‚¹ t:æŸ¥è¯¢çš„åŒºé—´å³ç«¯ç‚¹ p:èŠ‚ç‚¹æ ‡å·  
    if(l<=s && t<=r) return d[p];
    ll m = s + (t-s)/2;
    if(b[p]){
        d[p*2]+=(m-s+1)*b[p];
        d[p*2+1]+=(t-m)*b[p];
        b[p*2]+=b[p];
        b[p*2+1]+=b[p];
        b[p]=0;
    }
    ll sum=0;
    if(l<=m) sum+=getsum(l,r,s,m,p*2);
    if(r>m) sum+=getsum(l,r,m+1,t,p*2+1);
    return sum;
}
int main(){
    ll q,i1,i2,i3,i4;
    cin>>n>>q;
    for(ll i=1;i<=n;i++) cin>>a[i];
    build(1,n,1);
    while(q--){
        cin>>i1>>i2>>i3;
        if(i1==2){
            cout<<getsum(i2,i3,1,n,1)<<endl;
        }else{
            cin>>i4;
            update(i2,i3,i4,1,n,1);
        }
    }
    return 0;
}
```
## äº”ã€äºŒåˆ†æŸ¥æ‰¾
ä½¿ç”¨è´ªå¿ƒç®—æ³•+äºŒåˆ†æŸ¥æ‰¾çš„æ–¹æ³•ï¼Œå€ŸåŠ©`lower_bound`ï¼Œ`upper_bound`ç­‰å‡½æ•°å®ç°åœ¨$O(nlogn)$çš„æ—¶é—´å¤æ‚åº¦ä¸‹å®Œæˆå¯»æ‰¾ã€‚
### å¿«é€Ÿæ±‚åºåˆ—çš„æœ€é•¿é€’å¢(é€’å‡)å­åºåˆ—çš„é•¿åº¦ P1020
```c
#include <bits/stdc++.h>
using namespace std;

int main() {
    vector<int> a;
    int temp;
    while (cin >> temp) {
        a.push_back(temp);
    }
    int n = a.size();
    
    // å¤„ç†æœ€é•¿éé€’å¢å­åºåˆ—
    vector<int> dp1;
    for (int x : a) {
        // ä½¿ç”¨upper_boundåœ¨éé€’å¢æ•°ç»„ä¸­æ‰¾æ’å…¥ä½ç½®
        auto it = upper_bound(dp1.begin(), dp1.end(), x, greater<int>());
        //å¯»æ‰¾ç¬¬ä¸€ä¸ªå°äºxçš„ä½ç½®
        if (it == dp1.end()) {
            dp1.push_back(x);
        } else {
            *it = x;
        }
    }
    int res1 = dp1.size();
    
    // å¤„ç†æœ€é•¿é€’å¢å­åºåˆ—
    vector<int> dp2;
    for (int x : a) {
        // ä½¿ç”¨lower_boundåœ¨é€’å¢æ•°ç»„ä¸­æ‰¾æ’å…¥ä½ç½®
        auto it = lower_bound(dp2.begin(), dp2.end(), x);
        //å¯»æ‰¾ç¬¬ä¸€ä¸ªä¸å°äºxçš„ä½ç½®
        if (it == dp2.end()) {
            dp2.push_back(x);
        } else {
            *it = x;
        }
    }
    int res2 = dp2.size();
    
    cout << res1 << endl << res2 << endl;
    return 0;
}
```
### æ±‚åºåˆ—ä¸­æŸæ•°å‡ºç°æ¬¡æ•° P1102
```c
#include <bits/stdc++.h>
using namespace std;
using ll = long long;
int main() {
    int N, C;
    cin >> N >> C;
    vector<int> a(N);
    for (int i = 0; i < N; i++) {
        cin >> a[i];
    }
    sort(a.begin(), a.end());
    // ä»å°åˆ°å¤§æ’åº
    ll key = 0;
    for (auto it = a.begin(); it != a.end(); ++it) {
        int temp = *it + C;
        // å¯»æ‰¾ a ä¸­ç­‰äº temp çš„æ•°çš„ä¸ªæ•°
        auto it_lower = lower_bound(next(it), a.end(), temp);
        // it_lower ä¸ºç¬¬ä¸€ä¸ªå¤§äºç­‰äº temp çš„æ•°çš„ä¸‹æ ‡
        auto it_upper = upper_bound(next(it), a.end(), temp);
        // it_upper ä¸ºç¬¬ä¸€ä¸ªå¤§äº temp çš„æ•°çš„ä¸‹æ ‡
        ll count = it_upper - it_lower;
        key += count;
    }
    cout << key << endl;
}
```
## å…­ã€ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—å¿«é€Ÿè¾“å‡ºæœ€å¤§å…ƒç´ 

åœ¨ C++ ä¸­ï¼Œä¼˜å…ˆé˜Ÿåˆ—ï¼ˆ`priority_queue`ï¼‰æ˜¯ä¸€ç§å®¹å™¨é€‚é…å™¨ï¼Œç”¨äºå®ç°å †ï¼ˆHeapï¼‰æ•°æ®ç»“æ„ã€‚å®ƒå…è®¸æˆ‘ä»¬ä»¥é«˜æ•ˆçš„æ–¹å¼åŠ¨æ€åœ°æ’å…¥å…ƒç´ ï¼Œå¹¶å§‹ç»ˆèƒ½å¤Ÿå¿«é€Ÿè®¿é—®ä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ ï¼ˆé€šå¸¸æ˜¯æœ€å¤§å€¼æˆ–æœ€å°å€¼ï¼‰ã€‚ä¼˜å…ˆé˜Ÿåˆ—å¹¿æ³›åº”ç”¨äºå„ç§ç®—æ³•å’Œåœºæ™¯ä¸­ï¼Œä¾‹å¦‚ Dijkstra æœ€çŸ­è·¯å¾„ç®—æ³•ã€Huffman ç¼–ç ç­‰ã€‚

### åŸºæœ¬ç‰¹æ€§
- **åº•å±‚å®ç°**ï¼š`priority_queue` é»˜è®¤åŸºäºä¸€ä¸ªæœ€å¤§å †ï¼ˆMax Heapï¼‰å®ç°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œé˜Ÿåˆ—çš„é¡¶éƒ¨å…ƒç´ æ˜¯æœ€å¤§çš„ã€‚
- **è®¿é—®é™åˆ¶**ï¼šä¼˜å…ˆé˜Ÿåˆ—åªå…è®¸è®¿é—®ä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ ï¼ˆå³å †é¡¶å…ƒç´ ï¼‰ï¼Œå¹¶ä¸”åªèƒ½ä»é¡¶éƒ¨åˆ é™¤å…ƒç´ ã€‚æ— æ³•ç›´æ¥è®¿é—®å…¶ä»–å…ƒç´ ã€‚
- **æ—¶é—´å¤æ‚åº¦**ï¼š
  - æ’å…¥å…ƒç´ ï¼ˆ`push`ï¼‰ï¼š$\mathcal{O}(\log n)$
  - åˆ é™¤é¡¶éƒ¨å…ƒç´ ï¼ˆ`pop`ï¼‰ï¼š$\mathcal{O}(\log n)$
  - è®¿é—®é¡¶éƒ¨å…ƒç´ ï¼ˆ`top`ï¼‰ï¼š$\mathcal{O}(1)$
### åŸºæœ¬ç”¨æ³•
```c
#include <iostream>
#include <queue>

int main() {
    // å®šä¹‰ä¸€ä¸ªé»˜è®¤çš„æœ€å¤§å †ä¼˜å…ˆé˜Ÿåˆ—
    priority_queue<int> pq;

    // æ’å…¥å…ƒç´ 
    pq.push(10);
    pq.push(30);
    pq.push(20);

    // è¾“å‡ºä¼˜å…ˆé˜Ÿåˆ—çš„é¡¶éƒ¨å…ƒç´ 
    cout << "Top element: " << pq.top() << endl; // è¾“å‡º 30

    // åˆ é™¤é¡¶éƒ¨å…ƒç´ 
    pq.pop();

    // å†æ¬¡è¾“å‡ºé¡¶éƒ¨å…ƒç´ 
    cout << "Top element after pop: " << pq.top() << endl; // è¾“å‡º 20

    return 0;
}
```

### è‡ªå®šä¹‰æ¯”è¾ƒè§„åˆ™

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`priority_queue` æ˜¯ä¸€ä¸ªæœ€å¤§å †ã€‚å¦‚æœéœ€è¦å®ç°æœ€å°å †æˆ–å…¶ä»–è‡ªå®šä¹‰è§„åˆ™ï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°æ¥å®ç°ã€‚

#### ç¤ºä¾‹ï¼šå®ç°æœ€å°å †

```c
#include <iostream>
#include <queue>
#include <vector>

int main() {
    // ä½¿ç”¨ greater<int> å®ç°æœ€å°å †
    priority_queue<int, vector<int>, greater<int>> pq;

    // æ’å…¥å…ƒç´ 
    pq.push(10);
    pq.push(30);
    pq.push(20);

    // è¾“å‡ºä¼˜å…ˆé˜Ÿåˆ—çš„é¡¶éƒ¨å…ƒç´ 
    cout << "Top element (min heap): " << pq.top() << endl; // è¾“å‡º 10

    // åˆ é™¤é¡¶éƒ¨å…ƒç´ 
    pq.pop();

    // å†æ¬¡è¾“å‡ºé¡¶éƒ¨å…ƒç´ 
    cout << "Top element after pop: " << pq.top() << endl; // è¾“å‡º 20

    return 0;
}
```

#### ç¤ºä¾‹ï¼šè‡ªå®šä¹‰å¯¹è±¡çš„ä¼˜å…ˆé˜Ÿåˆ—

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè‡ªå®šä¹‰ç±» `Person`ï¼Œå¹¶å¸Œæœ›æ ¹æ®å¹´é¾„è¿›è¡Œæ’åºï¼š

```c
#include <iostream>
#include <queue>
#include <string>

struct Person {
    string name;
    int age;

    // æ„é€ å‡½æ•°
    Person(string name, int age) : name(name), age(age) {}
};

// è‡ªå®šä¹‰æ¯”è¾ƒè§„åˆ™
struct CompareAge {
    bool operator()(const Person& a, const Person& b) {
        return a.age < b.age; // æŒ‰å¹´é¾„ä»å¤§åˆ°å°æ’åº
    }
};

int main() {
    // å®šä¹‰ä¼˜å…ˆé˜Ÿåˆ—ï¼Œä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒè§„åˆ™
    priority_queue<Person, vector<Person>, CompareAge> pq;

    // æ’å…¥å…ƒç´ 
    pq.push(Person("Alice", 30));
    pq.push(Person("Bob", 25));
    pq.push(Person("Charlie", 35));

    // è¾“å‡ºä¼˜å…ˆé˜Ÿåˆ—çš„é¡¶éƒ¨å…ƒç´ 
    cout << "Top person: " << pq.top().name << " (" << pq.top().age << " years old)" << endl;

    return 0;
}
```

### é‡è¦æˆå‘˜å‡½æ•°

ä»¥ä¸‹æ˜¯ `priority_queue` çš„å¸¸ç”¨æˆå‘˜å‡½æ•°åŠå…¶åŠŸèƒ½ï¼š

| å‡½æ•°å       | åŠŸèƒ½æè¿°                                   |
|--||
| `push(value)` | å‘é˜Ÿåˆ—ä¸­æ’å…¥ä¸€ä¸ªå…ƒç´                      |
| `pop()`       | åˆ é™¤é˜Ÿåˆ—ä¸­çš„é¡¶éƒ¨å…ƒç´                      |
| `top()`       | è¿”å›é˜Ÿåˆ—ä¸­çš„é¡¶éƒ¨å…ƒç´ ï¼ˆä¸åˆ é™¤ï¼‰           |
| `empty()`     | æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º                         |
| `size()`      | è¿”å›é˜Ÿåˆ—ä¸­å…ƒç´ çš„æ•°é‡                     |

## ä¸ƒã€ä½¿ç”¨ç¨€ç–è¡¨ï¼ˆSTï¼‰é¢„å¤„ç†é™ä½æ—¶é—´å¤æ‚åº¦

### ä¾‹é¢˜ï¼ˆCSP-37-4ï¼‰
å·²çŸ¥ï¼š
$$f(l, r) = gcd(a_l, a_{l+1}, \ldots, a_r)$$
æ±‚ï¼š
$$\sum_{i=1}^{n} \sum_{j=i}^{n} (f(i, j) \times i \times j)$$


### Aã€æ„å»ºå¹¶ç”¨åŠ¨æ€è§„åˆ’å¡«å……ç¨€ç–è¡¨

ç¨€ç–è¡¨ï¼ˆSparse Tableï¼‰æ˜¯ä¸€ç§ç”¨äºå¿«é€ŸæŸ¥è¯¢åŒºé—´ä¿¡æ¯çš„æ•°æ®ç»“æ„ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œç¨€ç–è¡¨è¢«ç”¨æ¥é«˜æ•ˆåœ°å­˜å‚¨å’ŒæŸ¥è¯¢ä»»æ„åŒºé—´çš„æœ€å¤§å…¬çº¦æ•°ï¼ˆGCDï¼‰ã€‚ä»¥ä¸‹æ˜¯ç¨€ç–è¡¨çš„æ„å»ºè¿‡ç¨‹ï¼š

```c
int k = log2(n) + 1;
vector<vector<int>> st(n + 1, vector<int>(k + 1));
for (int i = 1; i <= n; ++i) {
    st[i][0] = a[i];
}
for (int j = 1; j <= k; ++j) {
    for (int i = 1; i + (1 << j) - 1 <= n; ++i) {
        st[i][j] = gcd(st[i][j - 1], st[i + (1 << (j - 1))][j - 1]);
    }
}
```

#### **1. åˆå§‹åŒ–ç¨€ç–è¡¨**
$$
st[i][0] = a[i]
$$
- ç¬¬ä¸€åˆ—è¡¨ç¤ºé•¿åº¦ä¸º$2^0 = 1$çš„åŒºé—´ï¼Œå› æ­¤ç›´æ¥åˆå§‹åŒ–ä¸ºæ•°ç»„ä¸­çš„å…ƒç´ å€¼ã€‚

#### **2. åŠ¨æ€è§„åˆ’å¡«å……ç¨€ç–è¡¨**
å¯¹äº$j \geq 1$ï¼Œé€šè¿‡åŠ¨æ€è§„åˆ’å…¬å¼å¡«å……ç¨€ç–è¡¨ï¼š
$$
st[i][j] = \text{gcd}(st[i][j-1], st[i + 2^{j-1}][j-1])
$$
-$st[i][j-1]$ï¼šè¡¨ç¤ºä»$i$å¼€å§‹ï¼Œé•¿åº¦ä¸º$2^{j-1}$çš„åŒºé—´çš„ GCDã€‚
-$st[i + 2^{j-1}][j-1]$ï¼šè¡¨ç¤ºä»$i + 2^{j-1}$å¼€å§‹ï¼Œé•¿åº¦ä¸º$2^{j-1}$çš„åŒºé—´çš„ GCDã€‚
- ä¸¤ä¸ªå­åŒºé—´çš„å¹¶é›†æ­£å¥½è¦†ç›–äº†ä»$i$å¼€å§‹ï¼Œé•¿åº¦ä¸º$2^j$çš„åŒºé—´ï¼Œå› æ­¤å®ƒä»¬çš„ GCD å°±æ˜¯æ•´ä¸ªå¤§åŒºé—´çš„ GCDã€‚



### Bã€å®šä¹‰åŒºé—´æŸ¥è¯¢å‡½æ•°

ä¸ºäº†å¿«é€ŸæŸ¥è¯¢ä»»æ„åŒºé—´çš„ GCD å€¼ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæŸ¥è¯¢å‡½æ•°ï¼š

```c
auto query_gcd = [&](int l, int r) {
    int len = r - l + 1;
    int j = log2(len);
    return gcd(st[l][j], st[r - (1 << j) + 1][j]);
};
```

#### **1. æŸ¥è¯¢åŸç†**
å¯¹äºä»»æ„åŒºé—´$[l, r]$ï¼Œå…¶ GCD å€¼å¯ä»¥é€šè¿‡ä¸¤ä¸ªé‡å å­åŒºé—´çš„ GCD å€¼è®¡ç®—å¾—åˆ°ï¼š
$$
\text{gcd}([l, r]) = \text{gcd}(st[l][j], st[r - 2^j + 1][j])
$$
å…¶ä¸­ï¼š
-$j = \lfloor \log_2(r - l + 1) \rfloor$ï¼Œå³æ»¡è¶³$2^j \leq r - l + 1$çš„æœ€å¤§æŒ‡æ•°ã€‚
-$st[l][j]$ï¼šè¡¨ç¤ºä»$l$å¼€å§‹ï¼Œé•¿åº¦ä¸º$2^j$çš„åŒºé—´çš„ GCDã€‚
-$st[r - 2^j + 1][j]$ï¼šè¡¨ç¤ºä»$r - 2^j + 1$å¼€å§‹ï¼Œé•¿åº¦ä¸º$2^j$çš„åŒºé—´çš„ GCDã€‚



### Cã€ä¸»é€»è¾‘ï¼šéå†æ‰€æœ‰èµ·å§‹ä½ç½®å¹¶è®¡ç®—è´¡çŒ®å€¼

ä»¥ä¸‹æ˜¯ä¸»é€»è¾‘éƒ¨åˆ†çš„ä»£ç ï¼š

```c
long long res = 0;
for (int i = 1; i <= n; ++i) {
    int current_gcd = a[i];
    int left = i;
    while (left <= n) {
        int l = left, r = n;
        int best = left;
        while (l <= r) {
            int mid = (l + r) / 2;
            if (query_gcd(i, mid) == current_gcd) {
                best = mid;
                l = mid + 1;
            } else {
                r = mid - 1;
            }
        }
        long long sum_j = (long long)(best + left) * (best - left + 1) / 2 % MOD;
        res = (res + (long long)current_gcd * i % MOD * sum_j % MOD) % MOD;
        left = best + 1;
        if (left <= n) {
            current_gcd = query_gcd(i, left);
        }
    }
}
cout << res << '\n';
```

#### **1. éå†æ¯ä¸ªèµ·å§‹ä½ç½®**
å¤–å±‚å¾ªç¯éå†æ•°ç»„ä¸­çš„æ¯ä¸ªèµ·å§‹ä½ç½®$i$ã€‚å¯¹äºæ¯ä¸ª$i$ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä»¥$i$ä¸ºèµ·ç‚¹çš„æ‰€æœ‰åŒºé—´ï¼Œå¹¶è®¡ç®—å®ƒä»¬å¯¹ç»“æœçš„è´¡çŒ®å€¼ã€‚

#### **2. ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ç¡®å®šåŒºé—´**
å†…å±‚å¾ªç¯é€šè¿‡äºŒåˆ†æŸ¥æ‰¾ç¡®å®šä»¥$i$ä¸ºèµ·ç‚¹çš„æœ€å¤§åŒºé—´$[left, best]$ï¼Œä½¿å¾—è¯¥åŒºé—´çš„ GCD å€¼ç­‰äº$\text{current\_gcd}$ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š
- å®šä¹‰æœç´¢èŒƒå›´$[l, r]$ï¼Œåˆå§‹å€¼ä¸º$[left, n]$ã€‚
- è®¡ç®—ä¸­é—´ç‚¹$mid = \lfloor \frac{l + r}{2} \rfloor$ã€‚
- å¦‚æœ$\text{query\_gcd}(i, mid) = \text{current\_gcd}$ï¼Œè¯´æ˜åŒºé—´å¯ä»¥æ‰©å±•åˆ°$mid$ï¼Œæ›´æ–°$best = mid$å¹¶ç»§ç»­å‘å³æœç´¢ã€‚
- å¦åˆ™ï¼Œå‘å·¦æ”¶ç¼©æœç´¢èŒƒå›´ã€‚

#### **3. è®¡ç®—åŒºé—´è´¡çŒ®å€¼**
å¯¹äºåŒºé—´$[left, best]$ï¼Œå…¶è´¡çŒ®å€¼ä¸ºï¼š
$$
\text{è´¡çŒ®å€¼} = \text{current\_gcd} \times i \times \sum_{j=left}^{best} j \mod MOD
$$
å…¶ä¸­ï¼š
-$\sum_{j=left}^{best} j$æ˜¯åŒºé—´$[left, best]$å†…æ‰€æœ‰ç´¢å¼•çš„å’Œï¼Œå…¬å¼ä¸ºï¼š
$$
\sum_{j=left}^{best} j = \frac{(best + left) \times (best - left + 1)}{2}
$$
- æœ€ç»ˆç»“æœç´¯åŠ åˆ°$\text{res}$ä¸­ï¼Œå¹¶å¯¹$MOD$å–æ¨¡ã€‚

#### **4. æ›´æ–°çŠ¶æ€**
- æ›´æ–°$left = best + 1$ï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªåŒºé—´ã€‚
- å¦‚æœ$left \leq n$ï¼Œæ›´æ–°$\text{current\_gcd} = \text{query\_gcd}(i, left)$ã€‚



### Dã€æ€»ç»“

1. **ç¨€ç–è¡¨çš„ä½œç”¨**ï¼šç¨€ç–è¡¨é€šè¿‡åŠ¨æ€è§„åˆ’çš„æ–¹å¼é¢„å¤„ç†æ•°ç»„ä¸­ä»»æ„åŒºé—´çš„ GCD å€¼ï¼Œæ”¯æŒ$O(1)$æ—¶é—´å¤æ‚åº¦çš„åŒºé—´æŸ¥è¯¢ã€‚
2. **äºŒåˆ†æŸ¥æ‰¾çš„ä¼˜åŒ–**ï¼šé€šè¿‡äºŒåˆ†æŸ¥æ‰¾ç¡®å®šä»¥æŸä¸ªèµ·å§‹ä½ç½®ä¸ºèµ·ç‚¹çš„æœ€å¤§åŒºé—´ï¼Œé¿å…æš´åŠ›æšä¸¾æ‰€æœ‰å¯èƒ½çš„åŒºé—´ã€‚
3. **è´¡çŒ®å€¼çš„è®¡ç®—**ï¼šåˆ©ç”¨æ•°å­¦å…¬å¼é«˜æ•ˆè®¡ç®—åŒºé—´å†…çš„ç´¢å¼•å’Œï¼Œä»è€Œå¿«é€Ÿç´¯åŠ è´¡çŒ®å€¼ã€‚
4. **æ—¶é—´å¤æ‚åº¦**ï¼š$O(nâ‹…lognâ‹…logV)$

## å…«ã€ä½¿ç”¨Dijkstraç®—æ³•å¯»æ‰¾æœ€å°è·¯å¾„

### **1. æ¦‚è¿°**
Dijkstra ç®—æ³•æ˜¯ä¸€ç§ç»å…¸çš„**å•æºæœ€çŸ­è·¯å¾„ç®—æ³•**ï¼Œç”¨äºåœ¨ä¸€ä¸ªåŠ æƒå›¾ä¸­æ‰¾åˆ°ä»ä¸€ä¸ªèµ·ç‚¹åˆ°å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚å®ƒç”±è·å…°è®¡ç®—æœºç§‘å­¦å®¶ Edsger W. Dijkstra åœ¨ 1956 å¹´æå‡ºã€‚

- **é€‚ç”¨åœºæ™¯**ï¼šé€‚ç”¨äºå¸¦éè´Ÿæƒå€¼çš„å›¾ã€‚
- **æ—¶é—´å¤æ‚åº¦**ï¼š
  - æ™®é€šå®ç°ï¼š$O(V^2 + E)$ï¼ˆç¨ å¯†å›¾ï¼‰ã€‚
  - ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–ï¼š$O((V + E) \log V)$ï¼ˆç¨€ç–å›¾ï¼‰ã€‚


### **2. æ ¸å¿ƒæ€æƒ³**

Dijkstra ç®—æ³•åŸºäºè´ªå¿ƒç­–ç•¥ï¼Œé€æ­¥æ‰©å±•å½“å‰å·²çŸ¥çš„æœ€çŸ­è·¯å¾„ï¼Œç›´åˆ°è¦†ç›–æ‰€æœ‰èŠ‚ç‚¹ã€‚å…¶æ ¸å¿ƒæ€æƒ³å¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š
1. **åˆå§‹åŒ–**ï¼šå°†èµ·ç‚¹çš„è·ç¦»è®¾ä¸º 0ï¼Œå…¶ä»–èŠ‚ç‚¹çš„è·ç¦»è®¾ä¸ºæ— ç©·å¤§ï¼ˆ$\infty$ï¼‰ã€‚
2. **é€‰æ‹©æœ€å°è·ç¦»èŠ‚ç‚¹**ï¼šä»æœªå¤„ç†çš„èŠ‚ç‚¹ä¸­é€‰æ‹©å½“å‰è·ç¦»æœ€å°çš„èŠ‚ç‚¹ä½œä¸ºå½“å‰èŠ‚ç‚¹ã€‚
3. **æ¾å¼›æ“ä½œ**ï¼šå°è¯•é€šè¿‡å½“å‰èŠ‚ç‚¹æ›´æ–°å…¶é‚»æ¥èŠ‚ç‚¹çš„è·ç¦»ã€‚å¦‚æœé€šè¿‡å½“å‰èŠ‚ç‚¹åˆ°è¾¾æŸä¸ªé‚»æ¥èŠ‚ç‚¹çš„è·ç¦»æ›´çŸ­ï¼Œåˆ™æ›´æ–°è¯¥é‚»æ¥èŠ‚ç‚¹çš„è·ç¦»ã€‚
4. **é‡å¤**ï¼šæ ‡è®°å½“å‰èŠ‚ç‚¹ä¸ºå·²å¤„ç†ï¼Œå¹¶ç»§ç»­é€‰æ‹©ä¸‹ä¸€ä¸ªæœªå¤„ç†ä¸”è·ç¦»æœ€å°çš„èŠ‚ç‚¹ï¼Œç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«å¤„ç†ã€‚



### **3. ç®—æ³•æ­¥éª¤**

ä»¥ä¸‹æ˜¯ Dijkstra ç®—æ³•çš„è¯¦ç»†æ­¥éª¤ï¼š

1. **åˆå§‹åŒ–**ï¼š
   - å®šä¹‰æ•°ç»„$\text{dist}[v]$ï¼Œç”¨äºå­˜å‚¨ä»èµ·ç‚¹åˆ°æ¯ä¸ªèŠ‚ç‚¹$v$çš„æœ€çŸ­è·ç¦»ï¼Œåˆå§‹å€¼ä¸º$\infty$ï¼Œèµ·ç‚¹çš„è·ç¦»ä¸º 0ã€‚
   - å®šä¹‰å¸ƒå°”æ•°ç»„$\text{visited}[v]$ï¼Œç”¨äºæ ‡è®°èŠ‚ç‚¹æ˜¯å¦å·²ç»å¤„ç†è¿‡ã€‚

2. **é€‰æ‹©å½“å‰èŠ‚ç‚¹**ï¼š
   - ä»æœªå¤„ç†çš„èŠ‚ç‚¹ä¸­é€‰æ‹©å½“å‰è·ç¦»æœ€å°çš„èŠ‚ç‚¹$u$ã€‚

3. **æ¾å¼›æ“ä½œ**ï¼š
   - éå†å½“å‰èŠ‚ç‚¹$u$çš„æ‰€æœ‰é‚»æ¥è¾¹$(u, v, w)$ï¼Œå°è¯•æ›´æ–°é‚»æ¥èŠ‚ç‚¹$v$çš„è·ç¦»ï¼š
    $$
     \text{dist}[v] = \min(\text{dist}[v], \text{dist}[u] + w)
    $$

4. **æ ‡è®°å·²å¤„ç†**ï¼š
   - å°†å½“å‰èŠ‚ç‚¹$u$æ ‡è®°ä¸ºå·²å¤„ç†ã€‚

5. **é‡å¤**ï¼š
   - é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«å¤„ç†æˆ–ä¼˜å…ˆé˜Ÿåˆ—ä¸ºç©ºã€‚


### **4. C++ å®ç°**

ä»¥ä¸‹æ˜¯ç”¨ C++ å®ç° Dijkstra ç®—æ³•çš„å…³é”®ä»£ç ï¼š

#### **æ•°æ®ç»“æ„å®šä¹‰**
```c
struct Edge {
    int to;     // ç›®æ ‡èŠ‚ç‚¹
    int weight; // è¾¹çš„æƒé‡
};
```

#### **æ ¸å¿ƒç®—æ³•**
```c
void dijkstra(int start, const vector<vector<Edge>>& graph, vector<int>& dist) {
    int n = graph.size(); // å›¾ä¸­èŠ‚ç‚¹çš„æ•°é‡
    dist.assign(n, INT_MAX); // åˆå§‹åŒ–è·ç¦»ä¸ºæ— ç©·å¤§
    dist[start] = 0; // èµ·ç‚¹åˆ°è‡ªèº«çš„è·ç¦»ä¸º 0

    // å®šä¹‰ä¼˜å…ˆé˜Ÿåˆ— (è·ç¦», èŠ‚ç‚¹)
    priority_queue<pair<int, int>, vector<pair<int, int>>, greater<>> pq;
    pq.push({0, start}); // å°†èµ·ç‚¹åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ—

    while (!pq.empty()) {
        auto [currentDist, u] = pq.top(); // å–å‡ºå½“å‰è·ç¦»æœ€å°çš„èŠ‚ç‚¹
        pq.pop();

        // å¦‚æœå½“å‰è·ç¦»å¤§äºå·²çŸ¥çš„æœ€çŸ­è·ç¦»ï¼Œè·³è¿‡
        if (currentDist > dist[u]) continue;

        // éå† u çš„æ‰€æœ‰é‚»æ¥è¾¹
        for (const Edge& edge : graph[u]) {
            int v = edge.to;
            int weight = edge.weight;

            // æ¾å¼›æ“ä½œï¼šå°è¯•æ›´æ–°åˆ° v çš„æ›´çŸ­è·¯å¾„
            if (dist[u] + weight < dist[v]) {
                dist[v] = dist[u] + weight; // æ›´æ–°æœ€çŸ­è·ç¦»
                pq.push({dist[v], v});      // å°†æ›´æ–°åçš„èŠ‚ç‚¹åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ—
            }
        }
    }
}
```



### **5. æ—¶é—´å¤æ‚åº¦åˆ†æ**

1. **æ™®é€šå®ç°**ï¼ˆä½¿ç”¨æ•°ç»„é€‰æ‹©æœ€å°è·ç¦»èŠ‚ç‚¹ï¼‰ï¼š
   - æ¯æ¬¡é€‰æ‹©æœ€å°è·ç¦»èŠ‚ç‚¹éœ€è¦$O(V)$ï¼Œå…±éœ€é€‰æ‹©$V$æ¬¡ã€‚
   - æ¯æ¬¡æ¾å¼›æ“ä½œéœ€è¦éå†æ‰€æœ‰è¾¹ï¼Œæ€»æ—¶é—´ä¸º$O(E)$ã€‚
   - æ€»æ—¶é—´å¤æ‚åº¦ä¸ºï¼š
    $$
     O(V^2 + E)
    $$

2. **ä¼˜åŒ–å®ç°**ï¼ˆä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼‰ï¼š
   - æ¯æ¬¡æ’å…¥å’Œåˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º$O(\log V)$ã€‚
   - æ€»æ—¶é—´å¤æ‚åº¦ä¸ºï¼š
    $$
     O((V + E) \log V)
    $$



### **6. æ³¨æ„äº‹é¡¹**

1. **è´Ÿæƒè¾¹**ï¼š
   - Dijkstra ç®—æ³•ä¸èƒ½å¤„ç†è´Ÿæƒè¾¹ã€‚å¦‚æœå›¾ä¸­å­˜åœ¨è´Ÿæƒè¾¹ï¼Œè¯·æ”¹ç”¨ Bellman-Ford ç®—æ³•ã€‚

2. **æ— å‘å›¾**ï¼š
   - å¦‚æœå›¾æ˜¯æ— å‘å›¾ï¼Œåœ¨æ·»åŠ è¾¹æ—¶éœ€è¦åŒæ—¶æ·»åŠ æ­£å‘å’Œåå‘è¾¹ã€‚

3. **ä¸å¯è¾¾èŠ‚ç‚¹**ï¼š
   - å¦‚æœæŸäº›èŠ‚ç‚¹æ— æ³•ä»èµ·ç‚¹åˆ°è¾¾ï¼Œå®ƒä»¬çš„è·ç¦»ä¼šä¿æŒä¸º$\infty$ï¼Œåœ¨è¾“å‡ºæ—¶å¯ä»¥ç”¨ "INF" è¡¨ç¤ºã€‚
## ä¹ã€unordered_mapä»£æ›¿ä¼ ç»Ÿå•å‘é“¾è¡¨

`unordered_map` æ˜¯ C++ æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªå…³è”å®¹å™¨ï¼Œç”¨äºå­˜å‚¨é”®å€¼å¯¹ï¼ˆkey-value pairsï¼‰ï¼Œå…¶åº•å±‚å®ç°æ˜¯**å“ˆå¸Œè¡¨ï¼ˆhash tableï¼‰**ã€‚ä¸ `map` ä¸åŒçš„æ˜¯ï¼Œ`unordered_map` ä¸ä¿è¯å…ƒç´ çš„é¡ºåºï¼Œä½†æä¾›äº†å¹³å‡æƒ…å†µä¸‹ **å¸¸æ•°æ—¶é—´å¤æ‚åº¦** çš„æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚

### ğŸ“Œ åŸºæœ¬ç‰¹æ€§

- **æ— åºæ€§ï¼ˆUnorderedï¼‰**ï¼šä¸æŒ‰ key çš„é¡ºåºæ’åˆ—ã€‚
- **å”¯ä¸€é”®ï¼ˆUnique keysï¼‰**ï¼šæ¯ä¸ª key åœ¨ map ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚
- **å¿«é€Ÿè®¿é—®**ï¼šåŸºäºå“ˆå¸Œå‡½æ•°å®ç°ï¼ŒæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤çš„æ—¶é—´å¤æ‚åº¦ä¸ºï¼š
  - å¹³å‡æƒ…å†µï¼šO(1)
  - æœ€åæƒ…å†µï¼šO(n)ï¼ˆå“ˆå¸Œå†²çªä¸¥é‡æ—¶ï¼‰

### ğŸ”§ å®šä¹‰å’Œåˆå§‹åŒ–

```c
unordered_map<key_type, value_type> map_name;
```

#### ç¤ºä¾‹ï¼šB3631 å•å‘é“¾è¡¨

##### é¢˜ç›®æè¿°

å®ç°ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œç»´æŠ¤ä¸€å¼ è¡¨ï¼ˆæœ€åˆåªæœ‰ä¸€ä¸ªå…ƒç´  $1$ï¼‰ã€‚éœ€è¦æ”¯æŒä¸‹é¢çš„æ“ä½œï¼Œå…¶ä¸­ $x$ å’Œ $y$ éƒ½æ˜¯ $1$ åˆ° $10^6$ èŒƒå›´å†…çš„æ­£æ•´æ•°ï¼Œä¸”ä¿è¯ä»»ä½•æ—¶é—´è¡¨ä¸­æ‰€æœ‰æ•°å­—å‡ä¸ç›¸åŒï¼Œæ“ä½œæ•°é‡ä¸å¤šäº $10^5$ï¼š

- `1 x y` ï¼šå°†å…ƒç´  $y$ æ’å…¥åˆ° $x$ åé¢ï¼›
- `2 x` ï¼šè¯¢é—® $x$ åé¢çš„å…ƒç´ æ˜¯ä»€ä¹ˆã€‚å¦‚æœ $x$ æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œåˆ™è¾“å‡º $0$ï¼›
- `3 x`ï¼šä»è¡¨ä¸­åˆ é™¤å…ƒç´  $x$ **åé¢çš„é‚£ä¸ªå…ƒç´ **ï¼Œä¸æ”¹å˜å…¶ä»–å…ƒç´ çš„å…ˆåé¡ºåºã€‚

```c
#include <bits/stdc++.h>
using namespace std;

int main() {
    int q;
    cin >> q;
    unordered_map<int, int> next_node; // å½“å‰èŠ‚ç‚¹ -> ä¸‹ä¸€èŠ‚ç‚¹
    next_node[1] = 0; // åˆå§‹åªæœ‰ä¸€ä¸ªå…ƒç´  1ï¼Œåé¢æ²¡æœ‰å…ƒç´ 
    while (q--) {
        int op;
        cin >> op;
        if (op == 1) {
            int x, y;
            cin >> x >> y;// æ’å…¥ y åˆ° x åé¢
            next_node[y] = next_node[x]; // y æŒ‡å‘ x åŸæ¥çš„ä¸‹ä¸€ä¸ª
            next_node[x] = y;             // x ç°åœ¨æŒ‡å‘ y
        } else if (op == 2) {
            int x;
            cin >> x;
            cout << next_node[x] << '\n';
        } else if (op == 3) {
            int x;
            cin >> x;
            int to_delete = next_node[x];
            if (to_delete != 0) {
                next_node[x] = next_node[to_delete]; // è·³è¿‡è¦åˆ é™¤çš„èŠ‚ç‚¹
                next_node.erase(to_delete);          // åˆ é™¤è¯¥èŠ‚ç‚¹
            }
        }
    }
    return 0;
}
```

### ğŸ§© å¸¸ç”¨æ“ä½œ

| æ“ä½œ | æè¿° |
|------|------|
| `map[key]` | è®¿é—®æˆ–æ’å…¥æŒ‡å®š key çš„å…ƒç´  |
| `map.at(key)` | è®¿é—®æŒ‡å®š key çš„å…ƒç´ ï¼Œè‹¥ä¸å­˜åœ¨åˆ™æŠ›å‡ºå¼‚å¸¸ |
| `map.insert({key, value})` | æ’å…¥é”®å€¼å¯¹ |
| `map.find(key)` | è¿”å›æŒ‡å‘è¯¥ key çš„è¿­ä»£å™¨ï¼Œè‹¥æœªæ‰¾åˆ°è¿”å› `end()` |
| `map.erase(key)` / `map.erase(it)` | åˆ é™¤æŒ‡å®š key æˆ–è¿­ä»£å™¨ä½ç½®çš„å…ƒç´  |
| `map.size()` | è¿”å›å½“å‰å…ƒç´ ä¸ªæ•° |
| `map.empty()` | åˆ¤æ–­æ˜¯å¦ä¸ºç©º |
| `map.clear()` | æ¸…ç©ºæ‰€æœ‰å…ƒç´  |


### âš™ï¸ è‡ªå®šä¹‰å“ˆå¸Œå‡½æ•°å’Œæ¯”è¾ƒå‡½æ•°

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`unordered_map` ä½¿ç”¨ `hash` æ¥è®¡ç®— key çš„å“ˆå¸Œå€¼ï¼Œå¹¶ä½¿ç”¨ `operator==` è¿›è¡Œç›¸ç­‰æ¯”è¾ƒã€‚å¦‚æœè¦ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹ä½œä¸º keyï¼Œåˆ™éœ€è¦æä¾›ç›¸åº”çš„å“ˆå¸Œå‡½æ•°å’Œæ¯”è¾ƒå‡½æ•°ã€‚

#### ç¤ºä¾‹ï¼šä½¿ç”¨è‡ªå®šä¹‰ç»“æ„ä½“ä½œä¸º key

```c
struct Point {
    int x, y;
    bool operator==(const Point& other) const {
        return x == other.x && y == other.y;
    }
};

// è‡ªå®šä¹‰å“ˆå¸Œå‡½æ•°
struct PointHash {
    size_t operator()(const Point& p) const {
        return hash<int>()(p.x) ^ (hash<int>()(p.y) << 1);
    }
};

int main() {
    unordered_map<Point, string, PointHash> pointMap;
    pointMap[{1, 2}] = "Point A";
    pointMap[{3, 4}] = "Point B";

    for (const auto& [key, val] : pointMap) {
        cout << "(" << key.x << ", " << key.y << "): " << val << "\n";
    }

    return 0;
}
```

### ğŸ†š unordered_map vs map

| ç‰¹æ€§ | `unordered_map` | `map` |
|------|------------------------|------------|
| å†…éƒ¨ç»“æ„ | å“ˆå¸Œè¡¨ | çº¢é»‘æ ‘ï¼ˆå¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼‰ |
| å…ƒç´ é¡ºåº | æ— åº | æŒ‰ key å‡åºæ’åˆ— |
| æ’å…¥/æŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦ | å¹³å‡ O(1)ï¼Œæœ€å·® O(n) | O(log n) |
| æ˜¯å¦æ”¯æŒè‡ªå®šä¹‰æ¯”è¾ƒ | æ”¯æŒï¼ˆéœ€è‡ªå®šä¹‰å“ˆå¸Œå’Œç­‰äºå‡½æ•°ï¼‰ | æ”¯æŒï¼ˆå¯é€šè¿‡æ¯”è¾ƒå‡½æ•°è‡ªå®šä¹‰æ’åºï¼‰ |