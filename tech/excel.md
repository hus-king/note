# Excel 常用公式记录

## 检查某值是否在另一列出现

- 公式：`=COUNTIF($B:$B, A2) > 0`
- 用途：判断单元格 `A2` 的值在列 `B` 中是否出现过。
- 原理：`COUNTIF` 统计范围 `$B:$B` 中等于 `A2` 的次数；次数大于 0 则表示存在。
- 返回：布尔值（`TRUE`/`FALSE`）。
- 示例：
	- 列 B 为学号列表，`A2` 为当前学号；若该学号已在列 B 中出现，返回 `TRUE`。
- 常见问题：
	- 比较的是完整匹配，不是包含匹配；若需要包含匹配可用通配符：`=COUNTIF($B:$B, "*" & A2 & "*") > 0`
	- 前后空格会影响匹配，可用 `TRIM` 清理：`=COUNTIF($B:$B, TRIM(A2)) > 0`

## 成绩查找并提供缺省值

- 公式：`=XLOOKUP(A2, B:B, C:C, "无成绩", 0)`
- 用途：以 `A2` 为查找键，在列 `B` 中查找，返回列 `C` 中对应的成绩；若找不到返回“无成绩”。
- 关键参数：
	- `A2`：查找值。
	- `B:B`：查找数组（键所在列）。
	- `C:C`：返回数组（结果所在列）。
	- `"无成绩"`：未找到时的返回值（缺省）。
	- `0`：匹配模式，`0` 表示精确匹配；可选值：`0` 精确、`-1` 精确或下一小项、`1` 精确或下一大项、`2` 通配符。
- 示例：
	- 列 B 为学号，列 C 为成绩；`A2` 输入学号，公式返回该学号对应成绩；若不存在则显示“无成绩”。
- 常见问题：
	- 精确匹配要求数据一致，注意数据类型、空格、前导零（如学号）等问题。
	- 如需模糊匹配（通配符），使用：`=XLOOKUP("*" & A2 & "*", B:B, C:C, "无成绩", 2)`。
	- 若你的 Excel 版本不支持 `XLOOKUP`，可用 `VLOOKUP` 替代：`=IFERROR(VLOOKUP(A2, B:C, 2, FALSE), "无成绩")`。

## 组合用法示例

- 检查学号是否存在并返回成绩（不存在则提示）：
	- `=IF(COUNTIF($B:$B, A2) > 0, XLOOKUP(A2, B:B, C:C, "无成绩", 0), "未找到该学号")`


